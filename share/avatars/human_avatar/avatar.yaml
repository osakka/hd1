# HD1 Avatar Specification - Human Avatar
# Single Source of Truth for Avatar Assets
# Auto-generated entity creation via API specification

metadata:
  name: "Human Avatar"
  description: "Professional human avatar for collaborative sessions - expressive and natural"
  version: "1.0.0"
  type: "session-avatar"
  created: "2025-07-04"
  attribution: "Khronos glTF Sample Model - SimpleMorph"

# Asset References (relative to avatar directory)
assets:
  model: "model.glb"           # 3D human model with morph targets
  textures: []                 # Embedded in GLB
  animations: []               # Embedded in GLB model

# Avatar Physical Properties
physical:
  # Default spawn transform
  default_transforms:
    position: {x: -2, y: 0, z: 0}      # Spawn on opposite side
    rotation: {x: 0, y: 180, z: 0}     # Face towards robot
    scale: {x: 1.0, y: 1.0, z: 1.0}   # Normal human scale
  
  # Camera positioning relative to avatar
  camera_offset: {x: 0, y: 1.75, z: 0}  # Human head height
  camera_follow_distance: 3.0            # Third-person distance
  
  # Physics properties
  physics:
    mass: 75.0                          # kg (average human)
    height: 1.75                        # meters
    collision_radius: 0.4               # meters

# HD1 Entity Definition (API-compatible)
entity:
  # HD1 tagging system
  tags: ['session-avatar', 'avatar', 'human', 'professional', 'user']
  
  # Entity name pattern
  name_template: "human-avatar-{session_id}-{user_id}"
  
  # PlayCanvas components
  components:
    transform:
      position: {x: -2, y: 0, z: 0}
      rotation: {x: 0, y: 180, z: 0}
      scale: {x: 1.0, y: 1.0, z: 1.0}
    
    model:
      type: "asset"
      asset_path: "model.glb"
      cast_shadows: true
      receive_shadows: true
    
    animation:
      assets: {}                        # Animations embedded in GLB
      default_state: "idle"
      transition_time: 0.25
    
    rigidbody:
      type: "kinematic"                 # Controlled movement
      mass: 75.0
      restitution: 0.0
      friction: 0.5
    
    collision:
      type: "capsule"
      radius: 0.4
      height: 1.75
    
    script:
      avatar_controller: true           # Enable avatar movement script
      network_sync: true                # Enable WebSocket sync

# Movement Configuration
movement:
  walk_speed: 2.0                       # m/s (natural human walking)
  run_speed: 5.0                        # m/s
  turn_speed: 180.0                     # degrees/s
  acceleration: 8.0                     # m/s²
  deceleration: 12.0                    # m/s²

# Animation State Machine
animations:
  states:
    idle:
      clip: "idle"
      loop: true
      transition_triggers:
        - {to: "walk", condition: "speed > 0.1"}
    
    walk:
      clip: "walk" 
      loop: true
      transition_triggers:
        - {to: "idle", condition: "speed < 0.1"}
        - {to: "run", condition: "speed > 3.0"}
    
    run:
      clip: "run"
      loop: true
      transition_triggers:
        - {to: "walk", condition: "speed < 3.0"}

# WebSocket Sync Configuration
network:
  sync_frequency: 30                    # Hz (standard human movement)
  position_threshold: 0.01              # meters
  rotation_threshold: 1.0               # degrees
  
  # Interpolation for smooth movement
  interpolation:
    enabled: true
    method: "linear"
    time: 0.1                           # seconds (natural human movement)