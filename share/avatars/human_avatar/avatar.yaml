# HD1 Avatar Specification - Human Avatar
# Single Source of Truth for Avatar Assets
# Auto-generated entity creation via API specification

metadata:
  name: "Human Avatar"
  description: "Professional human avatar for collaborative sessions - expressive and natural"
  version: "1.0.0"
  type: "session-avatar"
  created: "2025-07-04"
  attribution: "Khronos glTF Sample Model - SimpleMorph"

# Asset References (relative to avatar directory)
assets:
  model: "model.glb"           # 3D human model with morph targets
  textures: []                 # Embedded in GLB
  animations: []               # Embedded in GLB model

# Avatar Physical Properties
physical:
  # Default spawn transform
  default_transforms:
    position: {x: -2, y: 0, z: 0}      # Spawn on opposite side
    rotation: {x: 0, y: 180, z: 0}     # Face towards robot
    scale: {x: 1.0, y: 1.0, z: 1.0}   # Normal human scale
  
  # Camera positioning relative to avatar
  camera_offset: {x: 0, y: 1.75, z: 0}  # Human head height
  camera_follow_distance: 3.0            # Third-person distance
  
  # Physics properties
  physics:
    mass: 75.0                          # kg (average human)
    height: 1.75                        # meters
    collision_radius: 0.4               # meters

# HD1 Entity Definition (API-compatible)
entity:
  # HD1 tagging system
  tags: ['session-avatar', 'avatar', 'human', 'professional', 'user']
  
  # Entity name pattern
  name_template: "human-avatar-{session_id}-{user_id}"
  
  # PlayCanvas components
  components:
    transform:
      position: {x: -2, y: 0, z: 0}
      rotation: {x: 0, y: 180, z: 0}
      scale: {x: 1.0, y: 1.0, z: 1.0}
    
    model:
      type: "asset"
      asset_path: "model.glb"
      cast_shadows: true
      receive_shadows: true
    
    animation:
      assets: {}                        # Animations embedded in GLB
      default_state: "idle"
      transition_time: 0.25
    
    rigidbody:
      type: "kinematic"                 # Controlled movement
      mass: 75.0
      restitution: 0.0
      friction: 0.5
    
    collision:
      type: "capsule"
      radius: 0.4
      height: 1.75
    
    script:
      avatar_controller: true           # Enable avatar movement script
      network_sync: true                # Enable WebSocket sync

# Movement Configuration
movement:
  walk_speed: 2.0                       # m/s (natural human walking)
  run_speed: 5.0                        # m/s
  turn_speed: 180.0                     # degrees/s
  acceleration: 8.0                     # m/s²
  deceleration: 12.0                    # m/s²

# Animation State Machine
animations:
  states:
    idle:
      clip: "idle"
      loop: true
      transition_triggers:
        - {to: "walk", condition: "speed > 0.1"}
    
    walk:
      clip: "walk" 
      loop: true
      transition_triggers:
        - {to: "idle", condition: "speed < 0.1"}
        - {to: "run", condition: "speed > 3.0"}
    
    run:
      clip: "run"
      loop: true
      transition_triggers:
        - {to: "walk", condition: "speed < 3.0"}

# WebSocket Sync Configuration
network:
  sync_frequency: 30                    # Hz (standard human movement)
  position_threshold: 0.01              # meters
  rotation_threshold: 1.0               # degrees
  
  # Interpolation for smooth movement
  interpolation:
    enabled: true
    method: "linear"
    time: 0.1                           # seconds (natural human movement)

# Camera Configuration
camera:
  # Camera position relative to avatar
  position: {x: 0, y: 1.75, z: 0}      # Human eye level
  # Camera rotation (looking forward)
  rotation: {x: 0, y: 0, z: 0}         # Straight ahead
  # Field of view
  field_of_view: 75                     # degrees

# Physics Configuration - SINGLE SOURCE OF TRUTH
physics:
  # Core Physics Properties
  mass: 75.0                            # kg (average human)
  gravity_scale: 1.0                    # Standard gravity effect
  linear_damping: 0.1                   # Air resistance for movement
  angular_damping: 0.3                  # Rotational resistance
  
  # Collision Properties
  collision:
    type: "capsule"                     # Human-shaped collision
    radius: 0.4                         # meters
    height: 1.75                        # meters
    material:
      friction: 0.7                     # Ground grip
      restitution: 0.1                  # Bounce factor (low for humans)
      static_friction: 0.8              # Standing grip
  
  # Movement Capabilities
  locomotion:
    # Ground Movement
    can_walk: true
    walk_speed: 2.0                     # m/s
    run_speed: 5.0                      # m/s
    acceleration: 8.0                   # m/s²
    deceleration: 12.0                  # m/s²
    turn_speed: 180.0                   # degrees/s
    
    # Vertical Movement
    can_jump: true
    can_fly: false
    can_hover: false
    jump_force: 400.0                   # Newtons (realistic human jump)
    jump_cooldown: 1.0                  # seconds
    max_jumps: 1                        # Single jump only
    
    # Advanced Capabilities
    can_climb: true                     # Can climb ladders/walls
    can_swim: true                      # Can move in water
    climb_speed: 1.0                    # m/s
    swim_speed: 1.5                     # m/s
  
  # Environmental Interactions
  environment:
    affected_by_gravity: true
    affected_by_wind: true
    affected_by_water: true
    ground_detection: true              # Automatically detect ground
    wall_sliding: true                  # Slide along walls when walking into them
    step_height: 0.3                    # meters (can step over small obstacles)
  
  # Stamina/Energy System
  energy:
    max_stamina: 100.0
    stamina_drain_rate: 10.0            # per second when running
    stamina_recovery_rate: 20.0         # per second when walking/idle
    low_stamina_threshold: 20.0         # When movement slows down
  
  # Movement Modifiers
  modifiers:
    # Terrain effects
    grass_speed_multiplier: 1.0
    mud_speed_multiplier: 0.6
    ice_speed_multiplier: 0.8
    sand_speed_multiplier: 0.7
    
    # State effects
    crouching_speed_multiplier: 0.5
    injured_speed_multiplier: 0.3
    carrying_speed_multiplier: 0.8